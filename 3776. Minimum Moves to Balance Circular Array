class Solution {
public:
    long long minMoves(vector<int>& b) {
        int n = b.size();
        long long s = 0;
        int mn = -1;
        for(int i=0; i<n; i++){
            s += b[i];
            if(b[i] < 0){
                mn = i;
            }
        }
        if(s < 0){
            return -1;
        }
        if(mn == -1){
            return 0;
        }

        vector<long long> dist(n,0);

        for(int i=0; i<n; i++){
            if(i==mn){
                continue;
            }

            dist[min(abs(i-mn),n-abs(i-mn))] += b[i];
        }

        int i=1;
        long long target = -b[mn];
        long long ans = 0;

        while(i<n && target > 0){
            if(dist[i] >= target){
                ans += target * i;
                target = 0;
                break;
            }

            ans += dist[i] * i;
            target -= dist[i];
            i++;
        }
        
        return ans;
    }
};
